(this.webpackJsonpvca=this.webpackJsonpvca||[]).push([[0],{173:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){},176:function(e,t,n){},178:function(e,t,n){},179:function(e,t,n){},180:function(e,t,n){},181:function(e,t,n){"use strict";n.r(t);var r,c,a,o=n(1),i=n.n(o),s=n(58),l=n.n(s),u=(n(74),n(27)),d=n(35),f=n(16),b=n(13),m=n(17);!function(e){e.tilelayer="tilelayer",e.objectgroup="objectgroup"}(r||(r={})),function(e){e.orthagonal="orthagonal",e.isometric="isometric",e.staggered="staggered",e.hexagonal="hexagonal"}(c||(c={})),function(e){e.rightUp="right-up",e.rightDown="right-down",e.leftUp="left-up",e.leftDown="left-down"}(a||(a={}));var j=n(7),v=n(29),p=n(62),h=n(4),O=Object(o.forwardRef)((function(e,t){var n=Object(m.useApp)();return Object(h.jsx)(x,Object(f.a)(Object(f.a)({app:n},e),{},{ref:t}))})),x=Object(m.PixiComponent)("Viewport",{create:function(e){var t=new p.a({screenWidth:e.screenWidth,screenHeight:e.screenHeight,worldWidth:e.worldWidth,worldHeight:e.worldHeight,ticker:e.app.ticker}),n=e.minScale,r=void 0===n?.15:n,c=e.maxScale,a=void 0===c?1:c;return t.drag().pinch().wheel().clamp({direction:"all"}).setZoom(.15).clampZoom({minScale:r,maxScale:a}).decelerate(),t}}),g=O,w=128,y=64,k=function(e,t,n){var r=S(t,n)+64*e[0]+64*-e[1],c=(e[0]+e[1])*y/2+y+128;return new j.Point(r,c)},S=function(e,t){return 32*(t-e)+(t+e)*w/2/2},N=function(e,t){return t*e[1]+e[0]},E=n(64),C=Object(m.PixiComponent)("FloorTileLayer",{create:function(e){return new E.a(0,[e.texture])},applyProps:function(e,t,n){var r=n.layer,c=n.tileset,a=n.verticalTiles,o=n.horizontalTiles,i=n.spritesheet;if(r.data)for(var s=function(t){if(r.data[t]>0){var n=[t%o,Math.floor(t/o)],s=k(n,o,a),l=c.tiles.find((function(e){return e.id===r.data[t]-c.firstgid})),u=null===l||void 0===l?void 0:l.image.substr((null===l||void 0===l?void 0:l.image.lastIndexOf("/"))+1);e.addFrame(i.textures[u],s.x-64,s.y-y)}},l=0;l<r.data.length;l++)s(l)}}),T=n(24),M=function(e){var t=e.color,n=void 0===t?"red":t,r=Object(o.useRef)(null),c=Object(o.useRef)(),a=Object(o.useState)(e.position||new j.Point),i=Object(b.a)(a,2),s=i[0],l=(i[1],"".concat("/vca","/images/ui/marker-").concat(n,".svg"));Object(o.useEffect)((function(){T.a.from(r.current,{duration:1,ease:"elastic.out(2, 0.5)",pixi:{visible:!1,scale:.1}}).delay(e.delay||0)}),[e.delay]),Object(o.useEffect)((function(){var t;return!1!==e.bounce&&(t=T.a.to(r.current,{duration:.5,yoyo:!0,repeat:-1,pixi:{y:"-=40"}}).delay(1+Math.random())),function(){var e;null===(e=t)||void 0===e||e.kill()}}),[e.bounce]);var u=function(e){},d=function(){c.current=void 0},v=function(){};return Object(h.jsx)(m.Sprite,Object(f.a)(Object(f.a)({},e),{},{anchor:[.5,.5],position:s,ref:r,interactive:!0,image:l,mousedown:u,touchstart:u,mouseup:d,mouseupoutside:d,mousemove:v,touchmove:v}))},P=function(e,t){for(var n,r=t.length-1;r>=0&&!((n=t[r]).firstgid<=e);r--);return n},I=n(65),R=n(68),A=n(66),B=Object(m.PixiComponent)("ParticleEmitter",{create:function(){return new j.ParticleContainer(255,{})},applyProps:function(e,t,n){var r=n.image,c=n.config,a=Object(R.a)(n,["image","config"]);Object(m.applyDefaultProps)(e,t,a);var o=this._emitter;if(!o){o=new A.a(e,[j.Texture.from(r)],c);var i=performance.now();o.emit=!0,function e(){o.raf=requestAnimationFrame(e);var t=performance.now();o.update(3e-4*(t-i)),i=t}()}this._emitter=o},willUnmount:function(){this._emitter&&(this._emitter.emit=!1,cancelAnimationFrame(this._emitter.raf))}}),F=function(e){var t=e.x,n=void 0===t?0:t,r=e.y,c=void 0===r?0:r;return Object(h.jsx)(B,{name:"smoke",x:n,y:c,image:"".concat("/vca","/effects/smokeparticle.png"),config:I,pivot:[-64,0]})},L=n(6),D=Object(o.forwardRef)((function(e,t){return Object(h.jsx)(G,Object(f.a)(Object(f.a)({},e),{},{ref:t}))})),G=Object(m.PixiComponent)("SpriteAnimated",{create:function(e){var t=e.textures;return new j.AnimatedSprite(t||[],!0)},applyProps:function(e,t,n){t.textures!==n.textures&&(Object(m.applyDefaultProps)(e,t,n),e.gotoAndStop(e.currentFrame))}}),W=Object(o.memo)(D),H=function(e){var t=e.data,n=e.mapData,r=e.tilesetsTextures,c=e.found,a=e.onClick,i=Object(o.useRef)(null),s=Object(o.useRef)(null),l=Object(o.useRef)(),u=Object(o.useRef)();if(Object(o.useEffect)((function(){i.current&&T.a.from(i.current,{duration:1,ease:"elastic.out(2, 0.5)",pixi:{visible:!1,scale:.1}})}),[c]),Object(o.useEffect)((function(){var e,r,c,a,o;if(s.current){var i=null===(e=t.properties)||void 0===e?void 0:e.find((function(e){return"animation"===e.name}));if(i){var l=null===(r=t.properties)||void 0===r||null===(c=r.find((function(e){return"type"===e.name})))||void 0===c?void 0:c.value;if("move"===l)!function(){var e,r,c,a,l;try{l=JSON.parse(i.value)}catch(m){throw new Error("Couldn't parse animation steps: \"".concat(i.value,'"'))}var u=null===(e=t.properties)||void 0===e||null===(r=e.find((function(e){return"spritesheet"===e.name})))||void 0===r?void 0:r.value,d=parseFloat((null===(c=t.properties)||void 0===c||null===(a=c.find((function(e){return"delay"===e.name})))||void 0===a?void 0:a.value)||0);o=T.a.timeline({repeat:-1,delay:d});for(var f=function(e){var r,c,a=l[e-1],i=l[e],d=Math.sqrt(Math.pow(i[0]-a[0],2)+Math.pow(i[1]-a[1],2));s.current.gotoAndStop(0);var f=k(i,n.width,n.height),b=parseFloat((null===(r=t.properties)||void 0===r||null===(c=r.find((function(e){return"speed"===e.name})))||void 0===c?void 0:c.value)||.25);o.to(s.current,{onStart:function(){u&&(a[0]===i[0]&&a[1]>i[1]?(s.current.gotoAndStop(1),s.current.scale.set(1,1)):a[0]>i[0]&&a[1]===i[1]?(s.current.gotoAndStop(1),s.current.scale.set(-1,1)):a[0]===i[0]&&a[1]<i[1]?(s.current.gotoAndStop(0),s.current.scale.set(-1,1)):(s.current.gotoAndStop(0),s.current.scale.set(1,1)))},onUpdate:function(){s.current&&(s.current.zIndex=N(i,n.width))},duration:b*d,pixi:{x:f.x,y:f.y},ease:L.b.easeNone})},b=1;b<l.length;b++)f(b)}();else if("flicker"===l){a=setTimeout((function e(){s.current.visible=Math.random()<.5,a=setTimeout(e,250*Math.random())}),250*Math.random())}return function(){clearTimeout(a),o&&o.clear()}}}}),[n,t.properties]),t.polygon){var d=t.x,f=t.y,j=[d/y,f/y],v=t.polygon.reduce((function(e,t){return e.push(t.y+t.x),e.push(t.y/2-t.x/2),e}),[]);return Object(h.jsx)(m.Graphics,{draw:function(e){e.beginFill(12245589),e.drawPolygon(v),e.endFill()},position:k(j,n.width,n.height),pivot:[64,32]},"".concat(t.type).concat(t.name))}if(t.gid){var p,O,x=t.x,g=t.y,w=t.gid,S=[x/y-1,g/y-1],E=536870911&w;if(l.current=P(E,n.tilesets),!l||!l.current.tiles||0===w)return null;var C=0!==(1073741824&w),M=[1,1];0!==(2147483648&w)&&(M[0]*=-1),C&&(M[1]*=-1);var I=l.current.tiles.find((function(e){return e.id===E-l.current.firstgid}));if(!I)return null;var R=I.image.split("/"),A=Object(b.a)(R,3),B=(A[0],A[1]),F=A[2];r[B]||console.warn("Could not find spritesheet ".concat(B," ").concat(r)),u.current=r[B].textures,u.current[F]||console.warn("Could not find texture ".concat(B," ").concat(F));var D,G,H,z=null===(p=t.properties)||void 0===p||null===(O=p.find((function(e){return"spritesheet"===e.name})))||void 0===O?void 0:O.value;if(z)D=(null===(G=l.current)||void 0===G||null===(H=G.tiles)||void 0===H?void 0:H.filter((function(e){return e.type===z})).map((function(e){return e.image}))).map((function(e){var t,n=e.substr(e.lastIndexOf("/")+1);return null===(t=r[B].textures)||void 0===t?void 0:t[n]}));else D=[u.current[F]];return Object(h.jsxs)(W,{name:"".concat(t.name,": ").concat(x,",").concat(g," (").concat(F,")"),ref:s,scale:M,textures:D,anchor:[0,1],pivot:[64,0],position:k(S,n.width,n.height),pointerdown:function(){return a(t.name)},interactive:!!t.name,zIndex:N(S,n.width),children:[_(t.properties),c&&Object(h.jsx)(m.Sprite,{ref:i,image:"".concat("/vca","/images/ui/check.svg"),scale:.8,anchor:[-.1,1],pivot:[64,0]})]})}return null},_=function(e){if(!e)return null;var t,n,r=e.find((function(e){return"offset"===e.name}));if(r){var c=r.value.split(","),a=Object(b.a)(c,2);t=a[0],n=a[1]}var o=e.find((function(e){return"effect"===e.name}));return"smoke1"===(null===o||void 0===o?void 0:o.value)?Object(h.jsx)(F,{x:t,y:n}):null};var z,J,q,U,Z,X,V,$=function(e){var t=e.content,n=e.mistakeMode,c=e.foundSituations,a=e.mapData,i=e.tilesetsTextures,s=e.onSituationClick,l=Object(o.useState)(window.innerWidth),u=Object(b.a)(l,2),d=u[0],f=u[1],p=Object(o.useState)(window.innerHeight),O=Object(b.a)(p,2),x=O[0],w=O[1],y=64*(((null===a||void 0===a?void 0:a.width)||1)+((null===a||void 0===a?void 0:a.height)||1)),S=32*(((null===a||void 0===a?void 0:a.width)||1)+((null===a||void 0===a?void 0:a.height)||1))+128,N=Object(o.useRef)(null);Object(o.useEffect)((function(){N.current&&N.current.moveCenter(y/2,S/2)}),[a,S,y,i]),Object(o.useEffect)((function(){t.finder||v.a.add("plops",{url:"".concat("/vca","/sound/plops.mp3"),autoPlay:!0})}),[t.finder]),Object(o.useEffect)((function(){var e=function(){f(window.innerWidth),w(window.innerHeight)};return window.addEventListener("resize",e),window.addEventListener("orientationchange",e),function(){window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}}),[]);var E,T=function(e,t,n){return e.map((function(e,r){var c=536870911&e,o=P(c,a.tilesets);if(!o||!o.tiles||0===e)return null;var s=a.width,l=r%s,u=Math.floor(r/s),d=0!==(1073741824&e),f=[1,1];0!==(2147483648&e)&&(f[0]*=-1),d&&(f[1]*=-1);var j=o.tiles.find((function(e){return e.id===c-o.firstgid}));if(!j)return null;var v=j.image.split("/"),p=Object(b.a)(v,3),O=p[1],x=p[2];return i[O]||console.warn("Could not find spritesheet ".concat(x," ").concat(O," ").concat(i)),i[O].textures[x]||console.warn("Could not find texture ".concat(O," ").concat(x)),Object(h.jsx)(m.Sprite,{name:"".concat(t.name,": ").concat(l,",").concat(u," (").concat(x,")"),scale:f,texture:i[O].textures[x],anchor:[0,1],pivot:[64,0],position:k([l,u],a.width,a.height),zIndex:100*r+n},r)}))},I=function(e){return e.filter((function(e){return e.visible})).map((function(e,t){var n=c.indexOf(e.name)>-1;return Object(h.jsx)(H,{data:e,found:n,tilesetsTextures:i,mapData:a,onClick:s},"".concat(e.type).concat(e.name).concat(t))}))},R=function(t,r,c){var o=.25*c,i=k(r.location,a.width,a.height),s=e.correctScenarios.indexOf(t)>-1,l=e.wrongScenarios.indexOf(t)>-1,u="red";return s?u="green":n&&!l&&(u="yellow"),Object(h.jsx)(M,{position:i,pointertap:function(){return function(t){e.onScenarioClick(t)}(t)},delay:o,bounce:!s&&!l,color:u,name:t,scale:1.5},t)},A={sharedLoader:!0,backgroundColor:K(null===a||void 0===a?void 0:a.backgroundcolor)};return Object(h.jsx)(m.Stage,{width:d,height:x,className:"background",options:A,children:Object(h.jsxs)(g,{worldWidth:y,worldHeight:S,screenWidth:d,screenHeight:x,ref:N,children:[function(e){if(!e)return console.warn("No layer with name 'floor' found!"),null;var t=Q(e).find(Boolean);if(!t)return console.warn("Layer with name 'floor' is empty?"),null;var n=P(536870911&t,a.tilesets);if(!n)return console.warn("No tileset found for floor layer. Huh?"),null;var r=i[n.name];return j.utils.clearTextureCache(),r.spritesheet?Object(h.jsx)(C,{texture:r.spritesheet._texture,verticalTiles:a.height,horizontalTiles:a.width,layer:e,tileset:n,spritesheet:r.spritesheet}):(console.warn("No texture loaded found for floor layer. Was looking for ".concat(n.name)),null)}(a.layers.find((function(e){return"floor"===e.name}))),Object(h.jsx)(m.Container,{sortableChildren:!0,children:(E=a.layers,E.filter((function(e){return e.visible&&"floor"!==e.name&&e.type===r.tilelayer})).map((function(e,t){var n=Q(e);return T(n,e,t)})))}),Object(h.jsx)(m.Container,{sortableChildren:!0,children:function(e){return e.filter((function(e){return e.visible&&e.type===r.objectgroup})).map((function(e){return I(e.objects)}))}(a.layers)}),Object.entries(t.scenarios||[]).map((function(e,t){var n=Object(b.a)(e,2),r=n[0],c=n[1];return R(r,c,t)}))]})})},K=function(e){if(e)return parseInt(e.substring(1),16)},Q=function(e){var t=e.data;return"string"!==typeof t?t:(e.encoding,e.compression,[])};n(85);function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ee(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function te(e,t){var n=e.title,r=e.titleId,c=ee(e,["title","titleId"]);return o.createElement("svg",Y({xmlns:"http://www.w3.org/2000/svg",width:30.04,height:30.04,viewBox:"0 0 30.04 30.04",ref:t,"aria-labelledby":r},c),z||(z=o.createElement("defs",null,o.createElement("style",null,".a{fill:#fff;}.a,.b{stroke:#283583;stroke-linecap:round;stroke-linejoin:round;stroke-width:0.75px;}.b{fill:none;}"))),void 0===n?o.createElement("title",{id:r},"Back"):n?o.createElement("title",{id:r},n):null,J||(J=o.createElement("circle",{className:"a",cx:15.02,cy:15.02,r:14.65})),q||(q=o.createElement("path",{className:"b",d:"M11.64,16",transform:"translate(-0.97 -0.93)"})),U||(U=o.createElement("path",{className:"b",d:"M11.63,16",transform:"translate(-0.97 -0.93)"})),Z||(Z=o.createElement("path",{className:"b",d:"M20.38,22.88",transform:"translate(-0.97 -0.93)"})),X||(X=o.createElement("line",{className:"b",x1:19.39,y1:8.16,x2:10.65,y2:15.02})),V||(V=o.createElement("line",{className:"b",x1:19.39,y1:21.98,x2:10.65,y2:15.11})))}var ne=o.forwardRef(te),re=(n.p,function(e){var t=e.gameDataReceived,n=e.disableBackButton;return Object(o.useEffect)((function(){window.getGameData=function(){return window.GAMEDATA};var e=setInterval((function(){window.GAMEDATA&&(clearInterval(e),t(window.GAMEDATA))}),250);return function(){clearInterval(e)}}),[t]),!0===n?null:Object(h.jsx)("div",{className:"close",children:Object(h.jsx)(ne,{onClick:ce})})}),ce=function(){fe({type:"exit"})};window.setGameData=function(e){fe({type:"setGameData",data:e})},window.storeGameEvent=function(e){fe({type:"gameEvent",data:e})};var ae,oe,ie,se,le,ue,de,fe=function(e){if(window.hasOwnProperty("webkit")&&window.webkit.hasOwnProperty("messageHandlers")){var t=JSON.stringify(e);webkit.messageHandlers.cordova_iab.postMessage(t)}else window.parent.postMessage(e,"*")},be=n(182),me=(n(86),function(e){var t=e.foundSituations.length<e.content.situations.length;return Object(h.jsxs)("div",{className:"finder-box",children:["".concat(e.instructionText," (").concat(e.foundSituations.length,"/").concat(e.content.situations.length,")"),Object(h.jsx)("button",{className:"green button",disabled:t,onClick:e.onOpenGame,children:e.nextText})]})}),je=(n(87),function(e){var t=e.onBack,n=e.onSetGameData,r=e.content,c=Object(o.useRef)(null);return Object(o.useEffect)((function(){var e;null===c||void 0===c||null===(e=c.current)||void 0===e||e.addEventListener("load",(function(){var e,t;null===c||void 0===c||null===(e=c.current)||void 0===e||null===(t=e.contentWindow)||void 0===t||t.postMessage(r.data,"*")}),!0),window.addEventListener("message",(function(e){switch(e.data.type){case"setGameData":n(e.data.data);break;case"back":t&&t();break;case"exit":fe({type:"exit"})}}),!0)}),[r.data,t,n]),Object(h.jsx)("iframe",{src:r.url,ref:c,title:r.url,className:"iframe-content ".concat(e.open?"visible":"hidden")})}),ve=(n(88),function(e){var t=e.scenarios,n=e.correctScenarios,r=e.wrongScenarios,c=Object.keys(t),a=[].concat(Object(d.a)(n),Object(d.a)(r)),o=n.length+r.length<c.length;return Object(h.jsxs)("div",{className:"scenarios-box",children:["(".concat(a.length,"/").concat(c.length,")"),Object(h.jsx)("button",{className:"green button",disabled:o,onClick:e.onComplete,children:e.nextText})]})}),pe=n(183),he=n(47),Oe=n.n(he),xe=function(e){return Object(h.jsx)("ul",{children:e.reactions.map((function(t){return Object(h.jsx)("li",{onClick:function(){e.onSelect(t.id)},className:"".concat(e.selected===t.id?"selected":""),children:e.texts["reaction-".concat(e.scenario,"-").concat(t.id)]},t.id)}))})},ge=function(e){return e.correct?Object(h.jsx)("h1",{className:"correct",children:e.texts["feedback-correct"]}):Object(h.jsx)("h1",{className:"wrong",children:e.texts["feedback-wrong"]})};function we(){return(we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ye(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function ke(e,t){var n=e.title,r=e.titleId,c=ye(e,["title","titleId"]);return o.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:30.04,height:30.04,viewBox:"0 0 30.04 30.04",ref:t,"aria-labelledby":r},c),ae||(ae=o.createElement("defs",null,o.createElement("style",null,".a{fill:#fff;}.a,.b{stroke:#283583;stroke-linecap:round;stroke-linejoin:round;stroke-width:0.75px;}.b{fill:none;}"))),void 0===n?o.createElement("title",{id:r},"Back"):n?o.createElement("title",{id:r},n):null,oe||(oe=o.createElement("circle",{className:"a",cx:15.02,cy:15.02,r:14.65})),ie||(ie=o.createElement("path",{className:"b",d:"M11.64,16",transform:"translate(-0.97 -0.93)"})),se||(se=o.createElement("path",{className:"b",d:"M11.63,16",transform:"translate(-0.97 -0.93)"})),le||(le=o.createElement("path",{className:"b",d:"M20.38,22.88",transform:"translate(-0.97 -0.93)"})),ue||(ue=o.createElement("line",{className:"b",x1:19.39,y1:8.16,x2:10.65,y2:15.02})),de||(de=o.createElement("line",{className:"b",x1:19.39,y1:21.98,x2:10.65,y2:15.11})))}var Se,Ne,Ee,Ce,Te,Me,Pe,Ie=o.forwardRef(ke);n.p;function Re(){return(Re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ae(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function Be(e,t){var n=e.title,r=e.titleId,c=Ae(e,["title","titleId"]);return o.createElement("svg",Re({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 30 30",style:{enableBackground:"new 0 0 30 30"},xmlSpace:"preserve",ref:t,"aria-labelledby":r},c),Se||(Se=o.createElement("style",{type:"text/css"},"\n\t.st0{fill:#FFFFFF;stroke:#283583;stroke-width:0.75;stroke-linecap:round;stroke-linejoin:round;}\n\t.st1{fill:none;stroke:#283583;stroke-width:0.75;stroke-linecap:round;stroke-linejoin:round;}\n")),void 0===n?o.createElement("title",{id:r},"Back"):n?o.createElement("title",{id:r},n):null,Ne||(Ne=o.createElement("circle",{className:"st0",cx:15,cy:15,r:14.6})),Ee||(Ee=o.createElement("path",{className:"st1",d:"M10.7,15.1"})),Ce||(Ce=o.createElement("path",{className:"st1",d:"M10.7,15.1"})),Te||(Te=o.createElement("path",{className:"st1",d:"M19.4,21.9"})),Me||(Me=o.createElement("line",{className:"st1",x1:22.9,y1:7.2,x2:7.2,y2:22.9})),Pe||(Pe=o.createElement("line",{className:"st1",x1:22.9,y1:22.9,x2:7.2,y2:7.2})))}var Fe,Le=o.forwardRef(Be);n.p,n(173);T.a.registerPlugin(pe.a),function(e){e[e.description=0]="description",e[e.reactions=1]="reactions",e[e.feedback=2]="feedback"}(Fe||(Fe={}));var De,Ge,We=function(e,t){return e.startsWith("http")?e:t[e]},He=function(e){var t=e.content,n=e.texts,r=Object(o.useRef)(null),c=Object(o.useRef)(!!e.selectedReaction),a=Object(o.useState)(Fe.description),i=Object(b.a)(a,2),s=i[0],l=i[1],u=Object(o.useState)(),d=Object(b.a)(u,2),f=d[0],m=d[1],j=Object(o.useState)(e.selectedReaction),p=Object(b.a)(j,2),O=p[0],x=p[1],g=function(){l(Fe.description)};Object(o.useEffect)((function(){var e=setTimeout((function(){var e,t;null===(e=r.current)||void 0===e||null===(t=e.querySelector(".content"))||void 0===t||t.scroll({top:0,left:0,behavior:"smooth"})}),500);return function(){clearTimeout(e)}}),[s]),Object(o.useEffect)((function(){v.a.add("correct","".concat("/vca","/sound/correct.mp3")),v.a.add("wrong","".concat("/vca","/sound/wrong.mp3"))}),[]);var w=Object(o.useMemo)((function(){var r;if(!O)return"";var c=null===(r=t.reactions.find((function(e){return e.id===O})))||void 0===r?void 0:r.id;return n["reaction-".concat(e.scenario,"-").concat(c)]}),[t.reactions,e.scenario,n,O]),y=Object(o.useMemo)((function(){var e;return!!O&&!0===(null===(e=t.reactions.find((function(e){return e.id===O})))||void 0===e?void 0:e.correct)}),[t.reactions,O]),k=function(e){if("IMG"===e.target.tagName){var t,n=null===(t=e.target)||void 0===t?void 0:t.getAttribute("data-img");n&&m(n)}},S=Object(o.useMemo)((function(){return t.image&&s!==Fe.feedback?We(t.image,n):t.imageFeedback&&s===Fe.feedback?We(t.imageFeedback,n):null}),[t.image,t.imageFeedback,s,n]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"scenario-screen",ref:r,children:[Object(h.jsx)("div",{className:"illustration",children:Object(h.jsxs)("div",{className:"scaler",children:[S&&Object(h.jsx)("img",{src:S,alt:""}),t.hotspots&&s!==Fe.feedback&&t.hotspots.map((function(e){return Object(h.jsx)("img",{className:"hotspot",style:{left:"".concat(e.left,"%"),top:"".concat(e.top,"%"),width:"".concat(e.width,"%")},alt:"","data-img":We(e.image,n),onClick:k,src:We(e.hotspot,n)},We(e.image,n))}))]})}),Object(h.jsxs)("div",{className:"content state-".concat(Fe[s]," ").concat(c.current?"reopening":""),children:[Object(h.jsxs)("div",{className:"description",children:[Object(h.jsx)(Oe.a,{source:n["description-".concat(e.scenario)]}),Object(h.jsx)("div",{className:"buttons",children:Object(h.jsx)("button",{className:"button right-align white",onClick:function(){l(Fe.reactions)},children:n["button-next"]})})]}),Object(h.jsxs)("div",{className:"reactions",children:[Object(h.jsx)("h1",{children:n.reactions}),Object(h.jsx)(xe,{scenario:e.scenario,texts:n,selected:O,onSelect:x,reactions:t.reactions}),Object(h.jsxs)("div",{className:"buttons",children:[Object(h.jsx)("button",{className:"button white",onClick:g,children:n["button-prev"]}),Object(h.jsx)("button",{className:"button ".concat(O?"green":""),onClick:function(){l(Fe.feedback),setTimeout((function(){y?(v.a.play("correct"),e.onCorrectReaction(O)):(v.a.play("wrong"),e.onWrongReaction(O))}),500)},disabled:!O,children:n["button-check"]})]})]}),Object(h.jsxs)("div",{className:"feedback",children:[Object(h.jsx)(ge,{texts:n,correct:y}),Object(h.jsx)("p",{className:"reaction ".concat(y?"correct":"wrong"),children:w}),Object(h.jsx)("h1",{className:"title",children:n.feedback}),Object(h.jsx)(Oe.a,{source:n["feedback-".concat(e.scenario)]}),Object(h.jsxs)("div",{className:"buttons",children:[c.current&&Object(h.jsx)("button",{className:"button white",onClick:g,children:n["button-prev"]}),Object(h.jsx)("button",{className:"button green right-align",onClick:e.onBack,children:n["button-continue"]})]})]})]})]}),Object(h.jsx)("div",{className:"close",children:Object(h.jsx)(Ie,{onClick:e.onBack})}),f&&Object(h.jsxs)("div",{className:"image",children:[Object(h.jsx)("img",{src:f,alt:"img"}),Object(h.jsx)("div",{className:"close-image",children:Object(h.jsx)(Le,{onClick:function(){m(void 0)}})})]})]})},_e=(n(174),function(){return Object(h.jsxs)("div",{className:"loading-background",children:[Object(h.jsxs)("div",{className:"white-block",children:[Object(h.jsx)("div",{className:"outset"}),Object(h.jsx)("div",{className:"blue-block"})]}),Object(h.jsxs)("div",{className:"subtext",children:["Stay curious",Object(h.jsxs)("span",{className:"dots",children:[Object(h.jsx)("span",{className:"dot1",children:"."}),Object(h.jsx)("span",{className:"dot2",children:"."}),Object(h.jsx)("span",{className:"dot3",children:"."})]})]})]})}),ze=(n(175),function(e){return Object(h.jsx)("div",{className:"basedialog ".concat(e.className),children:e.children})});function Je(){return(Je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function qe(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function Ue(e,t){var n=e.title,r=e.titleId,c=qe(e,["title","titleId"]);return o.createElement("svg",Je({xmlns:"http://www.w3.org/2000/svg",width:141.478,height:134.378,viewBox:"0 0 141.478 134.378",ref:t,"aria-labelledby":r},c),n?o.createElement("title",{id:r},n):null,De||(De=o.createElement("defs",null,o.createElement("style",null,"\n            .star-empty {\n                fill: #f8f8f8;\n                stroke: #b0b0b0;\n                stroke-width: 3px;\n            }\n        "))),Ge||(Ge=o.createElement("path",{className:"star-empty",d:"M67.517,0l21.1,42.2,46.418,6.752L101.275,81.864l7.6,46.418L67.517,106.339,26.163,128.282l7.6-46.418L0,48.95,46.418,42.2Z",transform:"translate(3.223 3.354)"})))}var Ze=o.forwardRef(Ue),Xe=(n.p,n(176),function(e){return Object(h.jsxs)(ze,{className:"intro-dialog",children:[Object(h.jsx)("div",{className:"top",children:Object(h.jsx)("h1",{children:e.headerText})}),Object(h.jsx)("div",{className:"center",children:Object(h.jsx)("section",{children:e.descriptionText})}),Object(h.jsxs)("div",{className:"bottom",children:[Object(h.jsx)(Ze,{className:"star"}),Object(h.jsx)("span",{className:"stars-to-gain",children:e.starsToGainText}),Object(h.jsx)("button",{className:"green button start",onClick:e.onStart,children:e.startText})]})]})});n(48),n(67);var Ve,$e,Ke=function(e,t){var n=j.Loader.shared;n.resources[e]?t(n.resources[e]):n.add(e).load((function(n,r){t(r[e])}))},Qe=function(e){var t=Object(o.useState)({}),n=Object(b.a)(t,2),r=n[0],c=n[1],a=Object(o.useState)(),i=Object(b.a)(a,2),s=i[0],l=i[1],d=Object(o.useCallback)((function(e){l(e)}),[]);return Object(o.useEffect)((function(){if(s){var t=Ye(s,r);if(t){var n=t.name,a=e(t);Ke("".concat(a),(function(e){if(e.error)throw new Error("Loading ".concat(a,"\n").concat(e.error));var t=Object(f.a)(Object(f.a)({},r),{},Object(u.a)({},n,e));c(t)}))}}}),[s,e,r]),{loadComplete:!!s&&void 0===Ye(s,r),loadTilesets:d,tilesetsTextures:r}},Ye=function(e,t){return e.find((function(e){return!t[e.name]}))};function et(){return(et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function tt(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function nt(e,t){var n=e.title,r=e.titleId,c=tt(e,["title","titleId"]);return o.createElement("svg",et({xmlns:"http://www.w3.org/2000/svg",width:135.033,height:128.282,viewBox:"0 0 135.033 128.282",ref:t,"aria-labelledby":r},c),n?o.createElement("title",{id:r},n):null,Ve||(Ve=o.createElement("defs",null,o.createElement("style",null,"\n            .star-full {\n                fill: #fcda00;\n            }\n        "))),$e||($e=o.createElement("path",{className:"star-full",d:"M67.517,0l21.1,42.2,46.418,6.752L101.275,81.864l7.6,46.418L67.517,106.339,26.163,128.282l7.6-46.418L0,48.95,46.418,42.2Z"})))}var rt,ct=o.forwardRef(nt),at=(n.p,n(178),function(e){var t=e.total,n=e.mistakes,r=Math.max(t-n,0);Object(o.useEffect)((function(){window.setLevelScore&&window.setLevelScore(1,r,t)}),[r,t]);return Object(h.jsxs)(ze,{className:"complete-dialog",children:[Object(h.jsx)("div",{className:"block",children:Object(h.jsx)("h1",{children:e.headerText})}),Object(h.jsx)("div",{className:"block score",children:e.scoreText.replace("{0}",r.toString()).replace("{1}",t.toString())}),Object(h.jsx)("div",{className:"block stars",children:function(){for(var e=[],n=0;n<t;n++)e.push(Object(h.jsxs)("div",{children:[Object(h.jsx)(Ze,{}),n<r&&Object(h.jsx)(ct,{className:"full"})]},"star".concat(n)));return e}()}),Object(h.jsxs)("div",{className:"bottom",children:[Object(h.jsx)("button",{className:"green button",onClick:e.onTryAgain,children:e.tryAgainText}),Object(h.jsx)("button",{className:"red button",onClick:e.onExit,children:e.exitText})]})]})});n(179),n(180);window.PIXI=j,be.a.registerPIXI(j),T.a.registerPlugin(be.a),function(e){e[e.intro=0]="intro",e[e.normal=2]="normal",e[e.wrong=4]="wrong",e[e.correct=8]="correct",e[e.complete=16]="complete"}(rt||(rt={}));var ot=function(){var e,t=Object(o.useState)(rt.intro),n=Object(b.a)(t,2),r=n[0],c=n[1],a=Object(o.useState)({}),i=Object(b.a)(a,2),s=i[0],l=i[1],m=Object(o.useState)(),j=Object(b.a)(m,2),v=j[0],p=j[1],O=Object(o.useState)(),x=Object(b.a)(O,2),g=x[0],w=x[1],y=Object(o.useState)(),k=Object(b.a)(y,2),S=k[0],N=k[1],E=Object(o.useState)([]),C=Object(b.a)(E,2),T=C[0],M=C[1],P=Object(o.useState)({}),I=Object(b.a)(P,2),R=I[0],A=I[1],B=Object(o.useState)(!1),F=Object(b.a)(B,2),L=F[0],D=F[1],G=Object(o.useCallback)((function(){D(!1)}),[]),W=Object(o.useCallback)((function(e){window.setGameData(e)}),[]),H=Object(o.useCallback)((function(e){if(w(e),e.translations){var t=e.translations.reduce((function(e,t){return e[t.key]=t.value,e}),{});l(t)}}),[]),_=Object(o.useMemo)((function(){return null===g||void 0===g?void 0:g.content}),[g]),z=Object(o.useMemo)((function(){return null===g||void 0===g?void 0:g.levelsCompleted}),[g]),J=Qe(it),q=J.loadComplete,U=J.loadTilesets,Z=J.tilesetsTextures;Object(o.useEffect)((function(){if(_){var e=_.mapJson;Ke("".concat("/vca","/").concat(e),(function(e){p(e.data)}))}}),[_]),Object(o.useEffect)((function(){v&&U(v.tilesets)}),[U,v]),Object(o.useEffect)((function(){0}),[_,H]);var X=Object(o.useMemo)((function(){var e,t,n;if(z&&(null===_||void 0===_||null===(e=_.finder)||void 0===e?void 0:e.final))return Object(f.a)(Object(f.a)({},null===_||void 0===_||null===(t=_.finder)||void 0===t?void 0:t.final),{},{data:Object(f.a)(Object(f.a)({},null===_||void 0===_||null===(n=_.finder)||void 0===n?void 0:n.final.data),{},{levelsCompleted:z})})}),[_,z]),V=Object(o.useCallback)((function(){c(rt.normal)}),[]),K=Object(o.useMemo)((function(){var e,t,n=(null===z||void 0===z||null===(e=z[0])||void 0===e?void 0:e.score)||0,r=(null===_||void 0===_?void 0:_.stars)||(null===_||void 0===_||null===(t=_.finder)||void 0===t?void 0:t.situations.length)||Object.keys((null===_||void 0===_?void 0:_.scenarios)||{}).length||1;return(""+s["intro-stars-to-gain"]).replace("{0}",""+n).replace("{1}",""+r)}),[_,z,s]),Q=Object(o.useMemo)((function(){return Object.keys(R||{}).reduce((function(e,t){var n,r=null===g||void 0===g?void 0:g.content.scenarios[t];r&&(!!(null===(n=r.reactions.find((function(e){return e.id===R[t]})))||void 0===n?void 0:n.correct)?e.correctScenarios.push(t):e.wrongScenarios.push(t));return e}),{correctScenarios:[],wrongScenarios:[]})}),[null===g||void 0===g?void 0:g.content.scenarios,R]),Y=Q.correctScenarios,ee=Q.wrongScenarios;return Object(h.jsxs)(h.Fragment,{children:[!q&&Object(h.jsx)(_e,{}),Object(h.jsxs)("div",{className:"background",children:[Object(h.jsx)(re,{gameDataReceived:H,disableBackButton:!!L||!!S}),q&&Object(h.jsxs)(h.Fragment,{children:[r===rt.intro&&Object(h.jsx)(Xe,{onStart:V,headerText:s["intro-header"],descriptionText:s["intro-description"],starsToGainText:K,startText:s["intro-start"]}),r===rt.normal&&v&&_&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)($,{content:_,mapData:v,tilesetsTextures:Z,onSituationClick:function(e){(null===_||void 0===_?void 0:_.finder)&&_.finder.situations.indexOf(e)>-1&&-1===T.indexOf(e)&&M([].concat(Object(d.a)(T),[e]))},foundSituations:T,mistakeMode:null!==(e=null===_||void 0===_?void 0:_.mistakeMode)&&void 0!==e&&e,correctScenarios:Y,wrongScenarios:ee,onScenarioClick:function(e){N(e)}}),(null===_||void 0===_?void 0:_.finder)&&Object(h.jsx)(me,{content:_.finder,instructionText:s["finder-instruction"],nextText:s["button-next"],foundSituations:T,onOpenGame:function(){D(!0)}}),(null===_||void 0===_?void 0:_.scenarios)&&Object(h.jsx)(ve,{scenarios:_.scenarios,correctScenarios:Y,wrongScenarios:ee,instructionText:s["finder-instruction"],nextText:s["button-next"],onComplete:function(){c(rt.complete),W(Object(f.a)(Object(f.a)({},g),{},{levelsCompleted:[{level:1,score:Y.length,maxScore:Y.length}]}))}})]}),X&&Object(h.jsx)(je,{content:X,open:L,onBack:G,onSetGameData:W}),S&&Object(h.jsx)(He,{scenario:S,content:null===_||void 0===_?void 0:_.scenarios[S],selectedReaction:R[S],onCorrectReaction:function(e){A(Object(f.a)(Object(f.a)({},R),{},Object(u.a)({},S,e)))},onWrongReaction:function(e){(null===_||void 0===_?void 0:_.mistakeMode)&&A(Object(f.a)(Object(f.a)({},R),{},Object(u.a)({},S,e)))},texts:s,onBack:function(){N(void 0)}}),r===rt.complete&&Object(h.jsx)(at,{onTryAgain:function(){c(rt.normal),A({})},onExit:function(){fe({type:"exit"})},total:Object.keys(null===_||void 0===_?void 0:_.scenarios).length||0,mistakes:ee.length,headerText:s["complete-header"],scoreText:s["complete-score"],tryAgainText:s["complete-try-again"],exitText:s["complete-exit"]})]})]})]})},it=function(e){return"".concat("/vca","/maps/tilesets/").concat(e.name,".json")};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)(ot,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},65:function(e){e.exports=JSON.parse('{"alpha":{"start":0.25,"end":0},"scale":{"start":0.04,"end":0.29,"minimumScaleMultiplier":1},"color":{"start":"#85888d","end":"#100f0c"},"speed":{"start":100,"end":200,"minimumSpeedMultiplier":1},"acceleration":{"x":10,"y":-30},"maxSpeed":200,"startRotation":{"min":265,"max":270},"noRotation":false,"rotationSpeed":{"min":8,"max":0},"lifetime":{"min":0.5,"max":3.05},"blendMode":"normal","frequency":0.0005,"emitterLifetime":-1,"maxParticles":300,"pos":{"x":0,"y":0},"addAtBack":true,"spawnType":"point"}')},74:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){}},[[181,1,2]]]);
//# sourceMappingURL=main.e0a9e503.chunk.js.map
(this.webpackJsonpvca=this.webpackJsonpvca||[]).push([[0],{173:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){},176:function(e,t,n){},178:function(e,t,n){},179:function(e,t,n){},180:function(e,t,n){},181:function(e,t,n){"use strict";n.r(t);var r,c,a,i=n(1),o=n.n(i),s=n(58),l=n.n(s),u=(n(74),n(27)),d=n(35),f=n(16),b=n(13),m=n(17);!function(e){e.tilelayer="tilelayer",e.objectgroup="objectgroup"}(r||(r={})),function(e){e.orthagonal="orthagonal",e.isometric="isometric",e.staggered="staggered",e.hexagonal="hexagonal"}(c||(c={})),function(e){e.rightUp="right-up",e.rightDown="right-down",e.leftUp="left-up",e.leftDown="left-down"}(a||(a={}));var j=n(7),v=n(29),p=n(62),h=n(4),O=Object(i.forwardRef)((function(e,t){var n=Object(m.useApp)();return Object(h.jsx)(x,Object(f.a)(Object(f.a)({app:n},e),{},{ref:t}))})),x=Object(m.PixiComponent)("Viewport",{create:function(e){var t=new p.a({screenWidth:e.screenWidth,screenHeight:e.screenHeight,worldWidth:e.worldWidth,worldHeight:e.worldHeight,ticker:e.app.ticker}),n=e.minScale,r=void 0===n?.15:n,c=e.maxScale,a=void 0===c?1:c;return t.drag().pinch().wheel().clamp({direction:"all"}).setZoom(.15).clampZoom({minScale:r,maxScale:a}).decelerate(),t}}),g=O,w=128,y=64,k=function(e,t,n){var r=S(t,n)+64*e[0]+64*-e[1],c=(e[0]+e[1])*y/2+y+128;return new j.Point(r,c)},S=function(e,t){return 32*(t-e)+(t+e)*w/2/2},N=function(e,t){return t*e[1]+e[0]},E=n(64),C=Object(m.PixiComponent)("FloorTileLayer",{create:function(e){return new E.a(0,[e.texture])},applyProps:function(e,t,n){var r=n.layer,c=n.tileset,a=n.verticalTiles,i=n.horizontalTiles,o=n.spritesheet;if(r.data)for(var s=function(t){if(r.data[t]>0){var n=[t%i,Math.floor(t/i)],s=k(n,i,a),l=c.tiles.find((function(e){return e.id===r.data[t]-c.firstgid})),u=null===l||void 0===l?void 0:l.image.substr((null===l||void 0===l?void 0:l.image.lastIndexOf("/"))+1);e.addFrame(o.textures[u],s.x-64,s.y-y)}},l=0;l<r.data.length;l++)s(l)}}),T=n(24),M=function(e){var t=Object(i.useRef)(null),n=Object(i.useRef)(),r=Object(i.useState)(e.position||new j.Point),c=Object(b.a)(r,2),a=c[0],o=(c[1],e.bounce?"".concat("/vca","/images/ui/marker-red.svg"):"".concat("/vca","/images/ui/marker-green.svg"));Object(i.useEffect)((function(){T.a.from(t.current,{duration:1,ease:"elastic.out(2, 0.5)",pixi:{visible:!1,scale:.1}}).delay(e.delay||0)}),[e.delay]),Object(i.useEffect)((function(){var n;return!1!==e.bounce&&(n=T.a.to(t.current,{duration:.5,yoyo:!0,repeat:-1,pixi:{y:"-=40"}}).delay(1+Math.random())),function(){var e;null===(e=n)||void 0===e||e.kill()}}),[e.bounce]);var s=function(e){},l=function(){n.current=void 0},u=function(){};return Object(h.jsx)(m.Sprite,Object(f.a)(Object(f.a)({},e),{},{anchor:[.5,.5],position:a,ref:t,interactive:!0,image:o,mousedown:s,touchstart:s,mouseup:l,mouseupoutside:l,mousemove:u,touchmove:u}))},P=function(e,t){for(var n,r=t.length-1;r>=0&&!((n=t[r]).firstgid<=e);r--);return n},I=n(65),R=n(68),A=n(66),B=Object(m.PixiComponent)("ParticleEmitter",{create:function(){return new j.ParticleContainer(255,{})},applyProps:function(e,t,n){var r=n.image,c=n.config,a=Object(R.a)(n,["image","config"]);Object(m.applyDefaultProps)(e,t,a);var i=this._emitter;if(!i){i=new A.a(e,[j.Texture.from(r)],c);var o=performance.now();i.emit=!0,function e(){i.raf=requestAnimationFrame(e);var t=performance.now();i.update(3e-4*(t-o)),o=t}()}this._emitter=i},willUnmount:function(){this._emitter&&(this._emitter.emit=!1,cancelAnimationFrame(this._emitter.raf))}}),F=function(e){var t=e.x,n=void 0===t?0:t,r=e.y,c=void 0===r?0:r;return Object(h.jsx)(B,{name:"smoke",x:n,y:c,image:"".concat("/vca","/effects/smokeparticle.png"),config:I,pivot:[-64,0]})},L=n(6),D=Object(i.forwardRef)((function(e,t){return Object(h.jsx)(G,Object(f.a)(Object(f.a)({},e),{},{ref:t}))})),G=Object(m.PixiComponent)("SpriteAnimated",{create:function(e){var t=e.textures;return new j.AnimatedSprite(t||[],!0)},applyProps:function(e,t,n){t.textures!==n.textures&&(Object(m.applyDefaultProps)(e,t,n),e.gotoAndStop(e.currentFrame))}}),W=Object(i.memo)(D),H=function(e){var t=e.data,n=e.mapData,r=e.tilesetsTextures,c=e.found,a=e.onClick,o=Object(i.useRef)(null),s=Object(i.useRef)(null),l=Object(i.useRef)(),u=Object(i.useRef)();if(Object(i.useEffect)((function(){o.current&&T.a.from(o.current,{duration:1,ease:"elastic.out(2, 0.5)",pixi:{visible:!1,scale:.1}})}),[c]),Object(i.useEffect)((function(){var e,r,c,a,i;if(s.current){var o=null===(e=t.properties)||void 0===e?void 0:e.find((function(e){return"animation"===e.name}));if(o){var l=null===(r=t.properties)||void 0===r||null===(c=r.find((function(e){return"type"===e.name})))||void 0===c?void 0:c.value;if("move"===l)!function(){var e,r,c,a,l;try{l=JSON.parse(o.value)}catch(m){throw new Error("Couldn't parse animation steps: \"".concat(o.value,'"'))}var u=null===(e=t.properties)||void 0===e||null===(r=e.find((function(e){return"spritesheet"===e.name})))||void 0===r?void 0:r.value,d=parseFloat((null===(c=t.properties)||void 0===c||null===(a=c.find((function(e){return"delay"===e.name})))||void 0===a?void 0:a.value)||0);i=T.a.timeline({repeat:-1,delay:d});for(var f=function(e){var r,c,a=l[e-1],o=l[e],d=Math.sqrt(Math.pow(o[0]-a[0],2)+Math.pow(o[1]-a[1],2));s.current.gotoAndStop(0);var f=k(o,n.width,n.height),b=parseFloat((null===(r=t.properties)||void 0===r||null===(c=r.find((function(e){return"speed"===e.name})))||void 0===c?void 0:c.value)||.25);i.to(s.current,{onStart:function(){u&&(a[0]===o[0]&&a[1]>o[1]?(s.current.gotoAndStop(1),s.current.scale.set(1,1)):a[0]>o[0]&&a[1]===o[1]?(s.current.gotoAndStop(1),s.current.scale.set(-1,1)):a[0]===o[0]&&a[1]<o[1]?(s.current.gotoAndStop(0),s.current.scale.set(-1,1)):(s.current.gotoAndStop(0),s.current.scale.set(1,1)))},onUpdate:function(){s.current&&(s.current.zIndex=N(o,n.width))},duration:b*d,pixi:{x:f.x,y:f.y},ease:L.b.easeNone})},b=1;b<l.length;b++)f(b)}();else if("flicker"===l){a=setTimeout((function e(){s.current.visible=Math.random()<.5,a=setTimeout(e,250*Math.random())}),250*Math.random())}return function(){clearTimeout(a),i&&i.clear()}}}}),[n,t.properties]),t.polygon){var d=t.x,f=t.y,j=[d/y,f/y],v=t.polygon.reduce((function(e,t){return e.push(t.y+t.x),e.push(t.y/2-t.x/2),e}),[]);return Object(h.jsx)(m.Graphics,{draw:function(e){e.beginFill(12245589),e.drawPolygon(v),e.endFill()},position:k(j,n.width,n.height),pivot:[64,32]},"".concat(t.type).concat(t.name))}if(t.gid){var p,O,x=t.x,g=t.y,w=t.gid,S=[x/y-1,g/y-1],E=536870911&w;if(l.current=P(E,n.tilesets),!l||!l.current.tiles||0===w)return null;var C=0!==(1073741824&w),M=[1,1];0!==(2147483648&w)&&(M[0]*=-1),C&&(M[1]*=-1);var I=l.current.tiles.find((function(e){return e.id===E-l.current.firstgid}));if(!I)return null;var R=I.image.split("/"),A=Object(b.a)(R,3),B=(A[0],A[1]),F=A[2];r[B]||console.warn("Could not find spritesheet ".concat(B," ").concat(r)),u.current=r[B].textures,u.current[F]||console.warn("Could not find texture ".concat(B," ").concat(F));var D,G,H,z=null===(p=t.properties)||void 0===p||null===(O=p.find((function(e){return"spritesheet"===e.name})))||void 0===O?void 0:O.value;if(z)D=(null===(G=l.current)||void 0===G||null===(H=G.tiles)||void 0===H?void 0:H.filter((function(e){return e.type===z})).map((function(e){return e.image}))).map((function(e){var t,n=e.substr(e.lastIndexOf("/")+1);return null===(t=r[B].textures)||void 0===t?void 0:t[n]}));else D=[u.current[F]];return Object(h.jsxs)(W,{name:"".concat(t.name,": ").concat(x,",").concat(g," (").concat(F,")"),ref:s,scale:M,textures:D,anchor:[0,1],pivot:[64,0],position:k(S,n.width,n.height),pointerdown:function(){return a(t.name)},interactive:!!t.name,zIndex:N(S,n.width),children:[_(t.properties),c&&Object(h.jsx)(m.Sprite,{ref:o,image:"".concat("/vca","/images/ui/check.svg"),scale:.8,anchor:[-.1,1],pivot:[64,0]})]})}return null},_=function(e){if(!e)return null;var t,n,r=e.find((function(e){return"offset"===e.name}));if(r){var c=r.value.split(","),a=Object(b.a)(c,2);t=a[0],n=a[1]}var i=e.find((function(e){return"effect"===e.name}));return"smoke1"===(null===i||void 0===i?void 0:i.value)?Object(h.jsx)(F,{x:t,y:n}):null};var z,J,q,U,Z,X,V,$=function(e){var t=e.content,n=e.foundSituations,c=e.mapData,a=e.tilesetsTextures,o=e.onSituationClick,s=Object(i.useState)(window.innerWidth),l=Object(b.a)(s,2),u=l[0],d=l[1],f=Object(i.useState)(window.innerHeight),p=Object(b.a)(f,2),O=p[0],x=p[1],w=64*(((null===c||void 0===c?void 0:c.width)||1)+((null===c||void 0===c?void 0:c.height)||1)),y=32*(((null===c||void 0===c?void 0:c.width)||1)+((null===c||void 0===c?void 0:c.height)||1))+128,S=Object(i.useRef)(null);Object(i.useEffect)((function(){S.current&&S.current.moveCenter(w/2,y/2)}),[c,y,w,a]),Object(i.useEffect)((function(){t.finder||v.a.add("plops",{url:"".concat("/vca","/sound/plops.mp3"),autoPlay:!0})}),[t.finder]),Object(i.useEffect)((function(){var e=function(){d(window.innerWidth),x(window.innerHeight)};return window.addEventListener("resize",e),window.addEventListener("orientationchange",e),function(){window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}}),[]);var N,E=function(e,t,n){return e.map((function(e,r){var i=536870911&e,o=P(i,c.tilesets);if(!o||!o.tiles||0===e)return null;var s=c.width,l=r%s,u=Math.floor(r/s),d=0!==(1073741824&e),f=[1,1];0!==(2147483648&e)&&(f[0]*=-1),d&&(f[1]*=-1);var j=o.tiles.find((function(e){return e.id===i-o.firstgid}));if(!j)return null;var v=j.image.split("/"),p=Object(b.a)(v,3),O=p[1],x=p[2];return a[O]||console.warn("Could not find spritesheet ".concat(x," ").concat(O," ").concat(a)),a[O].textures[x]||console.warn("Could not find texture ".concat(O," ").concat(x)),Object(h.jsx)(m.Sprite,{name:"".concat(t.name,": ").concat(l,",").concat(u," (").concat(x,")"),scale:f,texture:a[O].textures[x],anchor:[0,1],pivot:[64,0],position:k([l,u],c.width,c.height),zIndex:100*r+n},r)}))},T=function(e){return e.filter((function(e){return e.visible})).map((function(e,t){var r=n.indexOf(e.name)>-1;return Object(h.jsx)(H,{data:e,found:r,tilesetsTextures:a,mapData:c,onClick:o},"".concat(e.type).concat(e.name).concat(t))}))},I=function(t,n,r){if(-1!==e.wrongScenarios.indexOf(t))return null;var a=.25*r,i=k(n.location,c.width,c.height),o=-1===e.correctScenarios.indexOf(t);return Object(h.jsx)(M,{position:i,pointertap:function(){return function(t){e.onScenarioClick(t)}(t)},delay:a,bounce:o,name:t,scale:1.5},t)},R={sharedLoader:!0,backgroundColor:K(null===c||void 0===c?void 0:c.backgroundcolor)};return Object(h.jsx)(m.Stage,{width:u,height:O,className:"background",options:R,children:Object(h.jsxs)(g,{worldWidth:w,worldHeight:y,screenWidth:u,screenHeight:O,ref:S,children:[function(e){if(!e)return console.warn("No layer with name 'floor' found!"),null;var t=Q(e).find(Boolean);if(!t)return console.warn("Layer with name 'floor' is empty?"),null;var n=P(536870911&t,c.tilesets);if(!n)return console.warn("No tileset found for floor layer. Huh?"),null;var r=a[n.name];return j.utils.clearTextureCache(),r.spritesheet?Object(h.jsx)(C,{texture:r.spritesheet._texture,verticalTiles:c.height,horizontalTiles:c.width,layer:e,tileset:n,spritesheet:r.spritesheet}):(console.warn("No texture loaded found for floor layer. Was looking for ".concat(n.name)),null)}(c.layers.find((function(e){return"floor"===e.name}))),Object(h.jsx)(m.Container,{sortableChildren:!0,children:(N=c.layers,N.filter((function(e){return e.visible&&"floor"!==e.name&&e.type===r.tilelayer})).map((function(e,t){var n=Q(e);return E(n,e,t)})))}),Object(h.jsx)(m.Container,{sortableChildren:!0,children:function(e){return e.filter((function(e){return e.visible&&e.type===r.objectgroup})).map((function(e){return T(e.objects)}))}(c.layers)}),Object.entries(t.scenarios||[]).map((function(e,t){var n=Object(b.a)(e,2),r=n[0],c=n[1];return I(r,c,t)}))]})})},K=function(e){if(e)return parseInt(e.substring(1),16)},Q=function(e){var t=e.data;return"string"!==typeof t?t:(e.encoding,e.compression,[])};n(85);function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ee(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function te(e,t){var n=e.title,r=e.titleId,c=ee(e,["title","titleId"]);return i.createElement("svg",Y({xmlns:"http://www.w3.org/2000/svg",width:30.04,height:30.04,viewBox:"0 0 30.04 30.04",ref:t,"aria-labelledby":r},c),z||(z=i.createElement("defs",null,i.createElement("style",null,".a{fill:#fff;}.a,.b{stroke:#283583;stroke-linecap:round;stroke-linejoin:round;stroke-width:0.75px;}.b{fill:none;}"))),void 0===n?i.createElement("title",{id:r},"Back"):n?i.createElement("title",{id:r},n):null,J||(J=i.createElement("circle",{className:"a",cx:15.02,cy:15.02,r:14.65})),q||(q=i.createElement("path",{className:"b",d:"M11.64,16",transform:"translate(-0.97 -0.93)"})),U||(U=i.createElement("path",{className:"b",d:"M11.63,16",transform:"translate(-0.97 -0.93)"})),Z||(Z=i.createElement("path",{className:"b",d:"M20.38,22.88",transform:"translate(-0.97 -0.93)"})),X||(X=i.createElement("line",{className:"b",x1:19.39,y1:8.16,x2:10.65,y2:15.02})),V||(V=i.createElement("line",{className:"b",x1:19.39,y1:21.98,x2:10.65,y2:15.11})))}var ne=i.forwardRef(te),re=(n.p,function(e){var t=e.gameDataReceived,n=e.disableBackButton;return Object(i.useEffect)((function(){window.getGameData=function(){return window.GAMEDATA};var e=setInterval((function(){window.GAMEDATA&&(clearInterval(e),t(window.GAMEDATA))}),250);return function(){clearInterval(e)}}),[t]),!0===n?null:Object(h.jsx)("div",{className:"close",children:Object(h.jsx)(ne,{onClick:ce})})}),ce=function(){fe({type:"exit"})};window.setGameData=function(e){fe({type:"setGameData",data:e})},window.storeGameEvent=function(e){fe({type:"gameEvent",data:e})};var ae,ie,oe,se,le,ue,de,fe=function(e){if(window.hasOwnProperty("webkit")&&window.webkit.hasOwnProperty("messageHandlers")){var t=JSON.stringify(e);webkit.messageHandlers.cordova_iab.postMessage(t)}else window.parent.postMessage(e,"*")},be=n(182),me=(n(86),function(e){var t=e.foundSituations.length<e.content.situations.length;return Object(h.jsxs)("div",{className:"finder-box",children:["".concat(e.instructionText," (").concat(e.foundSituations.length,"/").concat(e.content.situations.length,")"),Object(h.jsx)("button",{className:"green button",disabled:t,onClick:e.onOpenGame,children:e.nextText})]})}),je=(n(87),function(e){var t=e.onBack,n=e.onSetGameData,r=e.content,c=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e;null===c||void 0===c||null===(e=c.current)||void 0===e||e.addEventListener("load",(function(){var e,t;null===c||void 0===c||null===(e=c.current)||void 0===e||null===(t=e.contentWindow)||void 0===t||t.postMessage(r.data,"*")}),!0),window.addEventListener("message",(function(e){switch(e.data.type){case"setGameData":n(e.data.data);break;case"back":t&&t();break;case"exit":fe({type:"exit"})}}),!0)}),[r.data,t,n]),Object(h.jsx)("iframe",{src:r.url,ref:c,title:r.url,className:"iframe-content ".concat(e.open?"visible":"hidden")})}),ve=(n(88),function(e){var t=e.scenarios,n=e.correctScenarios,r=e.wrongScenarios,c=Object.keys(t),a=[].concat(Object(d.a)(n),Object(d.a)(r)),i=n.length+r.length<c.length;return Object(h.jsxs)("div",{className:"scenarios-box",children:["(".concat(a.length,"/").concat(c.length,")"),Object(h.jsx)("button",{className:"green button",disabled:i,onClick:e.onComplete,children:e.nextText})]})}),pe=n(183),he=n(47),Oe=n.n(he),xe=function(e){return Object(h.jsx)("ul",{children:e.reactions.map((function(t){return Object(h.jsx)("li",{onClick:function(){e.onSelect(t.id)},className:"".concat(e.selected===t.id?"selected":""),children:e.texts["reaction-".concat(e.scenario,"-").concat(t.id)]},t.id)}))})},ge=function(e){return e.correct?Object(h.jsx)("h1",{className:"correct",children:e.texts["feedback-correct"]}):Object(h.jsx)("h1",{className:"wrong",children:e.texts["feedback-wrong"]})};function we(){return(we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ye(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function ke(e,t){var n=e.title,r=e.titleId,c=ye(e,["title","titleId"]);return i.createElement("svg",we({xmlns:"http://www.w3.org/2000/svg",width:30.04,height:30.04,viewBox:"0 0 30.04 30.04",ref:t,"aria-labelledby":r},c),ae||(ae=i.createElement("defs",null,i.createElement("style",null,".a{fill:#fff;}.a,.b{stroke:#283583;stroke-linecap:round;stroke-linejoin:round;stroke-width:0.75px;}.b{fill:none;}"))),void 0===n?i.createElement("title",{id:r},"Back"):n?i.createElement("title",{id:r},n):null,ie||(ie=i.createElement("circle",{className:"a",cx:15.02,cy:15.02,r:14.65})),oe||(oe=i.createElement("path",{className:"b",d:"M11.64,16",transform:"translate(-0.97 -0.93)"})),se||(se=i.createElement("path",{className:"b",d:"M11.63,16",transform:"translate(-0.97 -0.93)"})),le||(le=i.createElement("path",{className:"b",d:"M20.38,22.88",transform:"translate(-0.97 -0.93)"})),ue||(ue=i.createElement("line",{className:"b",x1:19.39,y1:8.16,x2:10.65,y2:15.02})),de||(de=i.createElement("line",{className:"b",x1:19.39,y1:21.98,x2:10.65,y2:15.11})))}var Se,Ne,Ee,Ce,Te,Me,Pe,Ie=i.forwardRef(ke);n.p;function Re(){return(Re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ae(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function Be(e,t){var n=e.title,r=e.titleId,c=Ae(e,["title","titleId"]);return i.createElement("svg",Re({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 30 30",style:{enableBackground:"new 0 0 30 30"},xmlSpace:"preserve",ref:t,"aria-labelledby":r},c),Se||(Se=i.createElement("style",{type:"text/css"},"\n\t.st0{fill:#FFFFFF;stroke:#283583;stroke-width:0.75;stroke-linecap:round;stroke-linejoin:round;}\n\t.st1{fill:none;stroke:#283583;stroke-width:0.75;stroke-linecap:round;stroke-linejoin:round;}\n")),void 0===n?i.createElement("title",{id:r},"Back"):n?i.createElement("title",{id:r},n):null,Ne||(Ne=i.createElement("circle",{className:"st0",cx:15,cy:15,r:14.6})),Ee||(Ee=i.createElement("path",{className:"st1",d:"M10.7,15.1"})),Ce||(Ce=i.createElement("path",{className:"st1",d:"M10.7,15.1"})),Te||(Te=i.createElement("path",{className:"st1",d:"M19.4,21.9"})),Me||(Me=i.createElement("line",{className:"st1",x1:22.9,y1:7.2,x2:7.2,y2:22.9})),Pe||(Pe=i.createElement("line",{className:"st1",x1:22.9,y1:22.9,x2:7.2,y2:7.2})))}var Fe,Le=i.forwardRef(Be);n.p,n(173);T.a.registerPlugin(pe.a),function(e){e[e.description=0]="description",e[e.reactions=1]="reactions",e[e.feedback=2]="feedback"}(Fe||(Fe={}));var De,Ge,We=function(e,t){return e.startsWith("http")?e:t[e]},He=function(e){var t=e.content,n=e.texts,r=Object(i.useRef)(null),c=Object(i.useRef)(!!e.selectedReaction),a=Object(i.useState)(Fe.description),o=Object(b.a)(a,2),s=o[0],l=o[1],u=Object(i.useState)(),d=Object(b.a)(u,2),f=d[0],m=d[1],j=Object(i.useState)(e.selectedReaction),p=Object(b.a)(j,2),O=p[0],x=p[1],g=function(){l(Fe.description)};Object(i.useEffect)((function(){var e=setTimeout((function(){var e,t;null===(e=r.current)||void 0===e||null===(t=e.querySelector(".content"))||void 0===t||t.scroll({top:0,left:0,behavior:"smooth"})}),500);return function(){clearTimeout(e)}}),[s]),Object(i.useEffect)((function(){v.a.add("correct","".concat("/vca","/sound/correct.mp3")),v.a.add("wrong","".concat("/vca","/sound/wrong.mp3"))}),[]);var w=Object(i.useMemo)((function(){var r;if(!O)return"";var c=null===(r=t.reactions.find((function(e){return e.id===O})))||void 0===r?void 0:r.id;return n["reaction-".concat(e.scenario,"-").concat(c)]}),[t.reactions,e.scenario,n,O]),y=Object(i.useMemo)((function(){var e;return!!O&&!0===(null===(e=t.reactions.find((function(e){return e.id===O})))||void 0===e?void 0:e.correct)}),[t.reactions,O]),k=function(e){if("IMG"===e.target.tagName){var t,n=null===(t=e.target)||void 0===t?void 0:t.getAttribute("data-img");n&&m(n)}},S=Object(i.useMemo)((function(){return t.image&&s!==Fe.feedback?We(t.image,n):t.imageFeedback&&s===Fe.feedback?We(t.imageFeedback,n):null}),[t.image,t.imageFeedback,s,n]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"scenario-screen",ref:r,children:[Object(h.jsx)("div",{className:"illustration",children:Object(h.jsxs)("div",{className:"scaler",children:[S&&Object(h.jsx)("img",{src:S,alt:""}),t.hotspots&&s!==Fe.feedback&&t.hotspots.map((function(e){return Object(h.jsx)("img",{className:"hotspot",style:{left:"".concat(e.left,"%"),top:"".concat(e.top,"%"),width:"".concat(e.width,"%")},alt:"","data-img":We(e.image,n),onClick:k,src:We(e.hotspot,n)},We(e.image,n))}))]})}),Object(h.jsxs)("div",{className:"content state-".concat(Fe[s]," ").concat(c.current?"reopening":""),children:[Object(h.jsxs)("div",{className:"description",children:[Object(h.jsx)(Oe.a,{source:n["description-".concat(e.scenario)]}),Object(h.jsx)("div",{className:"buttons",children:Object(h.jsx)("button",{className:"button right-align white",onClick:function(){l(Fe.reactions)},children:n["button-next"]})})]}),Object(h.jsxs)("div",{className:"reactions",children:[Object(h.jsx)("h1",{children:n.reactions}),Object(h.jsx)(xe,{scenario:e.scenario,texts:n,selected:O,onSelect:x,reactions:t.reactions}),Object(h.jsxs)("div",{className:"buttons",children:[Object(h.jsx)("button",{className:"button white",onClick:g,children:n["button-prev"]}),Object(h.jsx)("button",{className:"button ".concat(O?"green":""),onClick:function(){l(Fe.feedback),setTimeout((function(){y?(v.a.play("correct"),e.onCorrectReaction(O)):(v.a.play("wrong"),e.onWrongReaction(O))}),500)},disabled:!O,children:n["button-check"]})]})]}),Object(h.jsxs)("div",{className:"feedback",children:[Object(h.jsx)(ge,{texts:n,correct:y}),Object(h.jsx)("p",{className:"reaction ".concat(y?"correct":"wrong"),children:w}),Object(h.jsx)("h1",{className:"title",children:n.feedback}),Object(h.jsx)(Oe.a,{source:n["feedback-".concat(e.scenario)]}),Object(h.jsxs)("div",{className:"buttons",children:[c.current&&Object(h.jsx)("button",{className:"button white",onClick:g,children:n["button-prev"]}),Object(h.jsx)("button",{className:"button green right-align",onClick:e.onBack,children:n["button-continue"]})]})]})]})]}),Object(h.jsx)("div",{className:"close",children:Object(h.jsx)(Ie,{onClick:e.onBack})}),f&&Object(h.jsxs)("div",{className:"image",children:[Object(h.jsx)("img",{src:f,alt:"img"}),Object(h.jsx)("div",{className:"close-image",children:Object(h.jsx)(Le,{onClick:function(){m(void 0)}})})]})]})},_e=(n(174),function(){return Object(h.jsxs)("div",{className:"loading-background",children:[Object(h.jsxs)("div",{className:"white-block",children:[Object(h.jsx)("div",{className:"outset"}),Object(h.jsx)("div",{className:"blue-block"})]}),Object(h.jsxs)("div",{className:"subtext",children:["Stay curious",Object(h.jsxs)("span",{className:"dots",children:[Object(h.jsx)("span",{className:"dot1",children:"."}),Object(h.jsx)("span",{className:"dot2",children:"."}),Object(h.jsx)("span",{className:"dot3",children:"."})]})]})]})}),ze=(n(175),function(e){return Object(h.jsx)("div",{className:"basedialog ".concat(e.className),children:e.children})});function Je(){return(Je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function qe(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function Ue(e,t){var n=e.title,r=e.titleId,c=qe(e,["title","titleId"]);return i.createElement("svg",Je({xmlns:"http://www.w3.org/2000/svg",width:141.478,height:134.378,viewBox:"0 0 141.478 134.378",ref:t,"aria-labelledby":r},c),n?i.createElement("title",{id:r},n):null,De||(De=i.createElement("defs",null,i.createElement("style",null,"\n            .star-empty {\n                fill: #f8f8f8;\n                stroke: #b0b0b0;\n                stroke-width: 3px;\n            }\n        "))),Ge||(Ge=i.createElement("path",{className:"star-empty",d:"M67.517,0l21.1,42.2,46.418,6.752L101.275,81.864l7.6,46.418L67.517,106.339,26.163,128.282l7.6-46.418L0,48.95,46.418,42.2Z",transform:"translate(3.223 3.354)"})))}var Ze=i.forwardRef(Ue),Xe=(n.p,n(176),function(e){return Object(h.jsxs)(ze,{className:"intro-dialog",children:[Object(h.jsx)("div",{className:"top",children:Object(h.jsx)("h1",{children:e.headerText})}),Object(h.jsx)("div",{className:"center",children:Object(h.jsx)("section",{children:e.descriptionText})}),Object(h.jsxs)("div",{className:"bottom",children:[Object(h.jsx)(Ze,{className:"star"}),Object(h.jsx)("span",{className:"stars-to-gain",children:e.starsToGainText}),Object(h.jsx)("button",{className:"green button start",onClick:e.onStart,children:e.startText})]})]})});n(48),n(67);var Ve,$e,Ke=function(e,t){var n=j.Loader.shared;n.resources[e]?t(n.resources[e]):n.add(e).load((function(n,r){t(r[e])}))},Qe=function(e){var t=Object(i.useState)({}),n=Object(b.a)(t,2),r=n[0],c=n[1],a=Object(i.useState)(),o=Object(b.a)(a,2),s=o[0],l=o[1],d=Object(i.useCallback)((function(e){l(e)}),[]);return Object(i.useEffect)((function(){if(s){var t=Ye(s,r);if(t){var n=t.name,a=e(t);Ke("".concat(a),(function(e){if(e.error)throw new Error("Loading ".concat(a,"\n").concat(e.error));var t=Object(f.a)(Object(f.a)({},r),{},Object(u.a)({},n,e));c(t)}))}}}),[s,e,r]),{loadComplete:!!s&&void 0===Ye(s,r),loadTilesets:d,tilesetsTextures:r}},Ye=function(e,t){return e.find((function(e){return!t[e.name]}))};function et(){return(et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function tt(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n,r,c={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function nt(e,t){var n=e.title,r=e.titleId,c=tt(e,["title","titleId"]);return i.createElement("svg",et({xmlns:"http://www.w3.org/2000/svg",width:135.033,height:128.282,viewBox:"0 0 135.033 128.282",ref:t,"aria-labelledby":r},c),n?i.createElement("title",{id:r},n):null,Ve||(Ve=i.createElement("defs",null,i.createElement("style",null,"\n            .star-full {\n                fill: #fcda00;\n            }\n        "))),$e||($e=i.createElement("path",{className:"star-full",d:"M67.517,0l21.1,42.2,46.418,6.752L101.275,81.864l7.6,46.418L67.517,106.339,26.163,128.282l7.6-46.418L0,48.95,46.418,42.2Z"})))}var rt,ct=i.forwardRef(nt),at=(n.p,n(178),function(e){var t=e.total,n=e.mistakes,r=Math.max(t-n,0);Object(i.useEffect)((function(){window.setLevelScore&&window.setLevelScore(1,r,t)}),[r,t]);return Object(h.jsxs)(ze,{className:"complete-dialog",children:[Object(h.jsx)("div",{className:"block",children:Object(h.jsx)("h1",{children:e.headerText})}),Object(h.jsx)("div",{className:"block score",children:e.scoreText.replace("{0}",r.toString()).replace("{1}",t.toString())}),Object(h.jsx)("div",{className:"block stars",children:function(){for(var e=[],n=0;n<t;n++)e.push(Object(h.jsxs)("div",{children:[Object(h.jsx)(Ze,{}),n<r&&Object(h.jsx)(ct,{className:"full"})]},"star".concat(n)));return e}()}),Object(h.jsxs)("div",{className:"bottom",children:[Object(h.jsx)("button",{className:"green button",onClick:e.onTryAgain,children:e.tryAgainText}),Object(h.jsx)("button",{className:"red button",onClick:e.onExit,children:e.exitText})]})]})});n(179),n(180);window.PIXI=j,be.a.registerPIXI(j),T.a.registerPlugin(be.a),function(e){e[e.intro=0]="intro",e[e.normal=2]="normal",e[e.wrong=4]="wrong",e[e.correct=8]="correct",e[e.complete=16]="complete"}(rt||(rt={}));var it=function(){var e=Object(i.useState)(rt.intro),t=Object(b.a)(e,2),n=t[0],r=t[1],c=Object(i.useState)({}),a=Object(b.a)(c,2),o=a[0],s=a[1],l=Object(i.useState)(),m=Object(b.a)(l,2),j=m[0],v=m[1],p=Object(i.useState)(),O=Object(b.a)(p,2),x=O[0],g=O[1],w=Object(i.useState)(0),y=Object(b.a)(w,2),k=(y[0],y[1],Object(i.useState)()),S=Object(b.a)(k,2),N=S[0],E=S[1],C=Object(i.useState)([]),T=Object(b.a)(C,2),M=T[0],P=T[1],I=Object(i.useState)({}),R=Object(b.a)(I,2),A=R[0],B=R[1],F=Object(i.useState)(!1),L=Object(b.a)(F,2),D=L[0],G=L[1],W=Object(i.useCallback)((function(){G(!1)}),[]),H=Object(i.useCallback)((function(e){window.setGameData(e)}),[]),_=Object(i.useCallback)((function(e){if(g(e),e.translations){var t=e.translations.reduce((function(e,t){return e[t.key]=t.value,e}),{});s(t)}}),[]),z=Object(i.useMemo)((function(){return null===x||void 0===x?void 0:x.content}),[x]),J=Object(i.useMemo)((function(){return null===x||void 0===x?void 0:x.levelsCompleted}),[x]),q=Qe(ot),U=q.loadComplete,Z=q.loadTilesets,X=q.tilesetsTextures;Object(i.useEffect)((function(){if(z){var e=z.mapJson;Ke("".concat("/vca","/").concat(e),(function(e){v(e.data)}))}}),[z]),Object(i.useEffect)((function(){j&&Z(j.tilesets)}),[Z,j]),Object(i.useEffect)((function(){0}),[z,_]);var V=Object(i.useMemo)((function(){var e,t,n;if(J&&(null===z||void 0===z||null===(e=z.finder)||void 0===e?void 0:e.final))return Object(f.a)(Object(f.a)({},null===z||void 0===z||null===(t=z.finder)||void 0===t?void 0:t.final),{},{data:Object(f.a)(Object(f.a)({},null===z||void 0===z||null===(n=z.finder)||void 0===n?void 0:n.final.data),{},{levelsCompleted:J})})}),[z,J]),K=Object(i.useCallback)((function(){r(rt.normal)}),[]),Q=Object(i.useMemo)((function(){var e,t,n=(null===J||void 0===J||null===(e=J[0])||void 0===e?void 0:e.score)||0,r=(null===z||void 0===z?void 0:z.stars)||(null===z||void 0===z||null===(t=z.finder)||void 0===t?void 0:t.situations.length)||Object.keys((null===z||void 0===z?void 0:z.scenarios)||{}).length||1;return(""+o["intro-stars-to-gain"]).replace("{0}",""+n).replace("{1}",""+r)}),[z,J,o]),Y=Object(i.useMemo)((function(){return Object.keys(A||{}).reduce((function(e,t){var n,r=null===x||void 0===x?void 0:x.content.scenarios[t];r&&(!!(null===(n=r.reactions.find((function(e){return e.id===A[t]})))||void 0===n?void 0:n.correct)?e.correctScenarios.push(t):e.wrongScenarios.push(t));return e}),{correctScenarios:[],wrongScenarios:[]})}),[null===x||void 0===x?void 0:x.content.scenarios,A]),ee=Y.correctScenarios,te=Y.wrongScenarios;return Object(h.jsxs)(h.Fragment,{children:[!U&&Object(h.jsx)(_e,{}),Object(h.jsxs)("div",{className:"background",children:[Object(h.jsx)(re,{gameDataReceived:_,disableBackButton:!!D||!!N}),U&&Object(h.jsxs)(h.Fragment,{children:[n===rt.intro&&Object(h.jsx)(Xe,{onStart:K,headerText:o["intro-header"],descriptionText:o["intro-description"],starsToGainText:Q,startText:o["intro-start"]}),n===rt.normal&&j&&z&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)($,{content:z,mapData:j,tilesetsTextures:X,onSituationClick:function(e){(null===z||void 0===z?void 0:z.finder)&&z.finder.situations.indexOf(e)>-1&&-1===M.indexOf(e)&&P([].concat(Object(d.a)(M),[e]))},foundSituations:M,correctScenarios:ee,wrongScenarios:te,onScenarioClick:function(e){E(e)}}),(null===z||void 0===z?void 0:z.finder)&&Object(h.jsx)(me,{content:z.finder,instructionText:o["finder-instruction"],nextText:o["button-next"],foundSituations:M,onOpenGame:function(){G(!0)}}),(null===z||void 0===z?void 0:z.scenarios)&&Object(h.jsx)(ve,{scenarios:z.scenarios,correctScenarios:ee,wrongScenarios:te,instructionText:o["finder-instruction"],nextText:o["button-next"],onComplete:function(){r(rt.complete),H(Object(f.a)(Object(f.a)({},x),{},{levelsCompleted:[{level:1,score:ee.length,maxScore:ee.length}]}))}})]}),V&&Object(h.jsx)(je,{content:V,open:D,onBack:W,onSetGameData:H}),N&&Object(h.jsx)(He,{scenario:N,content:null===z||void 0===z?void 0:z.scenarios[N],selectedReaction:A[N],onCorrectReaction:function(e){B(Object(f.a)(Object(f.a)({},A),{},Object(u.a)({},N,e)))},onWrongReaction:function(e){(null===z||void 0===z?void 0:z.mistakeMode)&&B(Object(f.a)(Object(f.a)({},A),{},Object(u.a)({},N,e)))},texts:o,onBack:function(){E(void 0)}}),n===rt.complete&&Object(h.jsx)(at,{onTryAgain:function(){r(rt.normal),B({})},onExit:function(){fe({type:"exit"})},total:Object.keys(null===z||void 0===z?void 0:z.scenarios).length||0,mistakes:te.length,headerText:o["complete-header"],scoreText:o["complete-score"],tryAgainText:o["complete-try-again"],exitText:o["complete-exit"]})]})]})]})},ot=function(e){return"".concat("/vca","/maps/tilesets/").concat(e.name,".json")};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(Object(h.jsx)(o.a.StrictMode,{children:Object(h.jsx)(it,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},65:function(e){e.exports=JSON.parse('{"alpha":{"start":0.25,"end":0},"scale":{"start":0.04,"end":0.29,"minimumScaleMultiplier":1},"color":{"start":"#85888d","end":"#100f0c"},"speed":{"start":100,"end":200,"minimumSpeedMultiplier":1},"acceleration":{"x":10,"y":-30},"maxSpeed":200,"startRotation":{"min":265,"max":270},"noRotation":false,"rotationSpeed":{"min":8,"max":0},"lifetime":{"min":0.5,"max":3.05},"blendMode":"normal","frequency":0.0005,"emitterLifetime":-1,"maxParticles":300,"pos":{"x":0,"y":0},"addAtBack":true,"spawnType":"point"}')},74:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){}},[[181,1,2]]]);
//# sourceMappingURL=main.2da257d8.chunk.js.map